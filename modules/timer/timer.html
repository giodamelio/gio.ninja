<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title id="title"></title>

    <!-- Moment.js -->
    <script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.7.0/moment.min.js"></script>

    <!-- My Js -->
    <script>
        // Set how often we update the display
        var interval = 1000;

        // Get the time from the url
        var increment = location.pathname.split("/")[1];
        var unit = location.pathname.split("/")[2];
        
        // Calculate the time to count until
        var duration = moment.duration(parseInt(increment), unit);

        // Wait until the dom is ready
        document.addEventListener("DOMContentLoaded", function() {
            // Get our display elements
            var timer = document.getElementById("timer");
            var title = document.getElementById("title");

            // Display the countdown every interval
            var id = setInterval(function() {
                // Recalculate the duration
                duration = moment.duration(duration.asMilliseconds() - interval, "milliseconds")

                // If the timer has reached 0, stop it and play the alarm
                if (duration.asMilliseconds() <= 0) {
                    clearInterval(id);
                    var alarm = new Audio("/marimba.mp3").play();
                }
                
                // Get the text equivalent of the duration
                var prettyDuration = duration.hours() + ":" + duration.minutes() + ":" + duration.seconds();

                // Set the timer element
                timer.innerText = prettyDuration;

                // Set the title
                title.innerText = prettyDuration;
            }, interval);
        });
    </script>
</head>
<body>
    <h1 id="timer"></h1>
</body>
</html>
